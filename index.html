<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Фёдор Конюхов «Путь к счастью» • Иммерсивная выставка в Кронштадте</title>
<meta name="description" content="Иммерсивная выставка Фёдора Конюхова «Путь к счастью». Кронштадт, 2025-2026.">

<!-- Предзагрузка критических ресурсов -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://unpkg.com">
<link rel="preconnect" href="https://cdnjs.cloudflare.com">

<!-- Inline критический CSS -->
<style>
:root {
  --dark-navy: #0a1520;
  --deep-blue: #0d1b2a;
  --ocean-deep: #08121e;
  --gold: #d4af37;
  --light-gold: #f4e8c1;
  --warm-white: #f8f5f0;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  background: #0a1520;
  color: var(--warm-white);
  line-height: 1.6;
  overflow-x: hidden;
  min-height: 100vh;
}

/* Критичные стили для первого экрана */
.hero-header {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  position: relative;
  padding: 20px;
  overflow: hidden;
}

/* Новый фон для первого экрана */
.hero-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
  opacity: 0;
  animation: fadeInBg 2s ease 0.5s forwards;
  background:
    linear-gradient(rgba(10, 21, 32, 0.85), rgba(10, 21, 32, 0.9)),
    url('https://konyukhov.ru/wp-content/uploads/2021/03/MG_8309s.jpg') center/cover no-repeat;
}

@keyframes fadeInBg {
  to { opacity: 1; }
}

.hero-content {
  max-width: 1200px;
  width: 100%;
  padding: 20px;
  z-index: 2;
  position: relative;
}

/* Минимальные стили для анимации текста */
.handwriting span {
  display: inline-block;
  opacity: 0;
  transform: translateY(50px);
}

/* Скелетоны для изображений */
.img-placeholder {
  background: linear-gradient(90deg, #0d1b2a 25%, #15273d 50%, #0d1b2a 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
  border-radius: 20px;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* Основные стили текста */
.hero-subtitle {
  font-size: clamp(1.2rem, 2.5vw, 1.6rem);
  margin: 30px 0 40px;
  opacity: 0;
  animation: fadeIn 0.5s 2s forwards;
  font-weight: 300;
}

.date-location {
  font-size: clamp(1rem, 2vw, 1.2rem);
  color: var(--gold);
  margin-bottom: 50px;
  opacity: 0;
  animation: fadeIn 0.5s 2.2s forwards;
  font-weight: 400;
}

@keyframes fadeIn {
  to { opacity: 1; }
}

/* Кнопка */
.buy-ticket-btn {
  display: inline-block;
  background: linear-gradient(135deg, var(--gold), var(--light-gold));
  color: #0b1828;
  padding: 18px 60px;
  border-radius: 50px;
  font-size: clamp(1.1rem, 1.8vw, 1.4rem);
  font-weight: 700;
  text-decoration: none;
  border: none;
  cursor: pointer;
  transition: transform 0.3s ease;
  opacity: 0;
  animation: fadeIn 0.5s 2.4s forwards;
}

.buy-ticket-btn:hover {
  transform: translateY(-5px);
}

/* Ссылки */
.text-link {
  color: var(--gold);
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: border-color 0.3s ease;
}

.text-link:hover {
  border-bottom-color: var(--gold);
}

/* Скрыть невидимые элементы */
[data-aos] {
  opacity: 0;
  transition: opacity 0.8s ease, transform 0.8s ease;
}

[data-aos].aos-animate {
  opacity: 1;
  transform: none;
}

/* Слайдер */
.slider-container {
  position: relative;
  max-width: 900px;
  margin: 0 auto;
  overflow: hidden;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
}

.slider {
  display: flex;
  transition: transform 0.5s ease;
}

.slide {
  min-width: 100%;
  height: 500px;
  position: relative;
}

.slider-nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0,0,0,0.5);
  color: var(--light-gold);
  border: none;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  transition: background 0.3s ease;
  z-index: 10;
}

.slider-nav:hover {
  background: rgba(0,0,0,0.8);
}

.prev { left: 20px; }
.next { right: 20px; }

.slider-dots {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 20px;
}

.dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: rgba(212,175,55,0.3);
  border: none;
  cursor: pointer;
  transition: background 0.3s ease;
}

.dot.active {
  background: var(--gold);
}

.more-images {
  text-align: center;
  margin-top: 40px;
  font-size: 1.1rem;
  color: rgba(248,245,240,0.9);
}

/* Карта */
#map {
  height: 400px;
  border-radius: 15px;
  border: 2px solid var(--gold);
  margin-top: 20px;
}

/* Контейнер для изображения перед текстом - УВЕЛИЧЕНА ВЫСОТА */
.hero-image-container {
  margin-bottom: 60px;
  border-radius: 20px;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
}

.hero-image-container .img-placeholder {
  height: 500px; /* Увеличена высота */
  width: 100%;
}

/* Социальные сети */
.social-links {
  display: flex;
  justify-content: center;
  gap: 30px;
  margin-top: 50px;
  margin-bottom: 30px;
}

.social-link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 50px;
  height: 50px;
  background: rgba(255,255,255,0.1);
  border-radius: 50%;
  color: var(--light-gold);
  font-size: 1.5rem;
  text-decoration: none;
  transition: all 0.3s ease;
  border: 1px solid rgba(212,175,55,0.3);
}

.social-link:hover {
  background: var(--gold);
  color: #0b1828;
  transform: translateY(-5px);
  border-color: var(--gold);
}

.social-placeholder {
  text-align: center;
  margin-top: 20px;
  font-size: 0.9rem;
  color: rgba(136, 170, 204, 0.7);
}

/* Стили для однородных иконок */
.feature-icon {
  font-size: 3rem;
  color: var(--gold);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 80px;
}

.feature-icon i {
  font-size: 2.5rem;
}

/* Стили для карточек с эксклюзивными возможностями - добавлены анимации */
.feature-card {
  background: rgba(255,255,255,0.03);
  padding: 40px 30px;
  border-radius: 20px;
  text-align: center;
  border: 1px solid rgba(212,175,55,0.2);
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.feature-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(212,175,55,0.05), rgba(244,232,193,0.05));
  opacity: 0;
  transition: opacity 0.4s ease;
  z-index: 0;
}

.feature-card:hover {
  transform: translateY(-15px) scale(1.03);
  border-color: var(--gold);
  box-shadow: 0 25px 50px rgba(0,0,0,0.4),
              0 0 0 1px rgba(212,175,55,0.1),
              0 0 30px rgba(212,175,55,0.2);
  background: rgba(255,255,255,0.05);
}

.feature-card:hover::before {
  opacity: 1;
}

.feature-card:hover .feature-icon {
  transform: scale(1.1);
  text-shadow: 0 0 20px rgba(212,175,55,0.5);
}

.feature-card:hover h3 {
  color: var(--gold);
  text-shadow: 0 0 10px rgba(212,175,55,0.3);
}

.feature-icon, .feature-card h3, .feature-card p {
  position: relative;
  z-index: 1;
  transition: all 0.4s ease;
}

.feature-card h3 {
  transition: color 0.4s ease, text-shadow 0.4s ease;
}

/* Эффект свечения для иконок при наведении */
.feature-card:hover .feature-icon i {
  filter: drop-shadow(0 0 8px rgba(212,175,55,0.6));
}

</style>

<!-- Отложенная загрузка остальных стилей -->
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&family=Bad+Script:wght@400;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
  <link href="https://fonts.googleapis.com/css2?family=Playfair Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&family=Bad+Script:wght@400;700&display=swap" rel="stylesheet">
</noscript>

<!-- Дефер загрузка AOS и Leaflet -->
<link rel="preload" href="https://unpkg.com/aos@2.3.1/dist/aos.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
</noscript>
</head>

<body>
<header class="hero-header">
  <!-- Новый фон с плавным появлением -->
  <div class="hero-background"></div>
  <div class="hero-content">
    <h1 class="handwriting" style="font-family:'Bad Script',cursive;font-size:clamp(3rem,7vw,6rem);color:var(--light-gold);margin-bottom:30px;line-height:1.2;">
      <span>П</span><span>у</span><span>т</span><span>ь</span>
      <span> </span><span>к</span><span> </span>
      <span>с</span><span>ч</span><span>а</span><span>с</span><span>т</span><span>ь</span><span>ю</span>
    </h1>
    <div class="title-line" style="height:2px;background:linear-gradient(90deg,transparent,var(--gold),transparent);width:0;margin:30px auto 40px;animation:line 1.5s 1.5s forwards;"></div>
    <p class="hero-subtitle">Иммерсивное путешествие в мир легендарного исследователя</p>
    <div class="date-location">
      25 декабря 2025 • Кронштадт, Музей "Воинско-морской славы России"
    </div>
    <div class="btn-wrapper" style="margin:40px 0 60px;">
      <a href="https://mvms.tn-cloud.ru/event/DA09C5B33464E62FDF718FC56D5FDC27E0C3C819/2025-12-04" target="_blank" class="buy-ticket-btn" onclick="countClick()">Купить билет</a>
    </div>
    <div class="stats-container" style="display:flex;justify-content:center;gap:clamp(30px,5vw,60px);flex-wrap:wrap;opacity:0;animation:fadeIn 0.5s 2.6s forwards;">
      <div class="stat-item" style="text-align:center;">
        <div class="stat-number" id="clickCounter" style="font-size:clamp(2rem,4vw,3rem);color:var(--gold);font-weight:700;">0</div>
        <div class="stat-label" style="font-size:0.9rem;color:rgba(248,245,240,0.8);">Переходов к покупке</div>
      </div>
      <div class="stat-item" style="text-align:center;">
        <div class="stat-number" id="ticketCounter" style="font-size:clamp(2rem,4vw,3rem);color:var(--gold);font-weight:700;">0</div>
        <div class="stat-label" style="font-size:0.9rem;color:rgba(248,245,240,0.8);">Билетов продано</div>
      </div>
    </div>
  </div>
</header>

<main>
  <section class="about-section" style="padding:80px 20px;max-width:1300px;margin:0 auto;">
    <h2 class="section-title" data-aos="fade-up" style="font-family:'Playfair Display',serif;font-size:clamp(2rem,4vw,3rem);text-align:center;color:var(--light-gold);margin-bottom:60px;position:relative;">
      Легенда океанов
      <span style="content:'';display:block;width:100px;height:3px;background:var(--gold);margin:20px auto 0;box-shadow:0 0 20px rgba(212,175,55,0.6);"></span>
    </h2>
    
    <!-- Новое изображение перед текстом с увеличенной высотой -->
    <div class="hero-image-container" data-aos="fade-up">
      <div class="img-placeholder" id="heroImage"></div>
    </div>
    
    <div style="display:grid;grid-template-columns:1fr;gap:60px;">
      <div class="about-text" data-aos="fade-up" style="font-family:'Inter',sans-serif;">
        <p style="margin-bottom:1.5em;font-size:clamp(1rem,1.5vw,1.1rem);line-height:1.7;color:rgba(248,245,240,0.9);">
          <strong style="color:var(--light-gold);font-weight:600;">Фёдор Конюхов</strong> — человек, который превратил одиночество в философию, а океан — в храм. Первый в мире, кто достиг пяти полюсов нашей планеты: Северного и Южного географических, Полюса относительной недоступности в Северном Ледовитом океане, Эвереста (полюс высоты) и мыса Горн (полюс яхтсменов).
        </p>
        <p style="margin-bottom:2em;font-size:clamp(1rem,1.5vw,1.1rem);line-height:1.7;color:rgba(248,245,240,0.9);">
          Он пересёк Атлантический океан на вёсельной лодке за рекордные 46 суток, совершил кругосветное плавание на яхте, прошёл на собачьих упряжках к Северному полюсу и совершил одиночный полёт вокруг света на воздушном шаре.
        </p>
        <div class="quote" style="font-family:'Playfair Display',serif;font-style:italic;font-size:clamp(1.2rem,2vw,1.5rem);color:var(--light-gold);padding:40px;border-left:3px solid var(--gold);background:rgba(212,175,55,0.05);margin:40px 0;border-radius:0 15px 15px 0;line-height:1.5;">
          «Счастье — это когда ты находишься в гармонии с собой и миром. Океан научил меня этому — в его бескрайних просторах исчезает всё лишнее, остаётся только суть»
        </div>
        <p style="font-size:clamp(1rem,1.5vw,1.1rem);line-height:1.7;color:rgba(248,245,240,0.9);">
          За свою жизнь Фёдор провёл в океанах более 1000 дней, написал более 3000 картин и 17 книг. Его картины — не просто изображения моря, а отпечатки души человека, который смотрел в глаза штормам и находил в них покой.
        </p>
        <p style="margin-top:40px;font-size:clamp(1rem,1.5vw,1.1rem);line-height:1.7;color:rgba(248,245,240,0.9);">
          <strong>Здесь Вы можете посмотреть работы путешественника:</strong> 
          <a href="https://konyukhov.ru/projects/paintings/?ysclid=mip2f9irtt746212813" target="_blank" class="text-link" style="color:var(--gold);text-decoration:none;border-bottom:1px solid var(--gold);">konyukhov.ru</a>
        </p>
        <p style="margin-top:20px;font-size:clamp(1rem,1.5vw,1.1rem);line-height:1.7;color:rgba(248,245,240,0.9);">
          <strong>Также Вы можете посмотреть, как проходила наша выставка в Ростове-на-Дону:</strong> 
          <a href="https://artspacerostov.ru/" target="_blank" class="text-link" style="color:var(--gold);text-decoration:none;border-bottom:1px solid var(--gold);">artspacerostov.ru</a>
        </p>
      </div>
    </div>
  </section>

  <section class="gallery-section" style="padding:80px 20px;background:rgba(13,27,42,0.3);">
    <h2 class="section-title" data-aos="fade-up" style="font-family:'Playfair Display',serif;font-size:clamp(2rem,4vw,3rem);text-align:center;color:var(--light-gold);margin-bottom:60px;">
      Галерея
    </h2>
    <div class="slider-container" data-aos="fade-up">
      <div class="slider" id="imageSlider">
        <!-- Слайды будут добавлены через JavaScript -->
      </div>
      <button class="slider-nav prev" onclick="prevSlide()">‹</button>
      <button class="slider-nav next" onclick="nextSlide()">›</button>
      <div class="slider-dots" id="sliderDots"></div>
    </div>
    <div class="more-images" data-aos="fade-up">
      Больше изображений Вы можете посмотреть <a href="https://artfedor.ru/" target="_blank" class="text-link">здесь</a>
    </div>
  </section>

  <section class="features-section" style="padding:80px 20px;max-width:1400px;margin:0 auto;">
    <h2 class="section-title" data-aos="fade-up" style="font-family:'Playfair Display',serif;font-size:clamp(2rem,4vw,3rem);text-align:center;color:var(--light-gold);margin-bottom:60px;">
      Эксклюзивные возможности
    </h2>
    <div class="features-container" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(min(100%,350px),1fr));gap:40px;">
      <div class="feature-card" data-aos="fade-up">
        <div class="feature-icon">
          <i class="fas fa-book"></i>
        </div>
        <h3 style="font-size:1.3rem;color:var(--light-gold);margin-bottom:15px;">Розыгрыш книг с автографом</h3>
        <p style="font-size:0.95rem;line-height:1.6;color:rgba(248,245,240,0.9);">Каждый билет — это шанс получить уникальное издание с личным автографом Фёдора Конюхова.</p>
      </div>
      
      <div class="feature-card" data-aos="fade-up" data-aos-delay="100">
        <div class="feature-icon">
          <i class="fas fa-camera"></i>
        </div>
        <h3 style="font-size:1.3rem;color:var(--light-gold);margin-bottom:15px;">#КонюховКронштадт</h3>
        <p style="font-size:0.95rem;line-height:1.6;color:rgba(248,245,240,0.9);">Публикуйте фото с выставки с нашим хештегом и получите эксклюзивный сувенир.</p>
      </div>
      
      <div class="feature-card" data-aos="fade-up" data-aos-delay="200">
        <div class="feature-icon">
          <i class="fas fa-microphone-alt"></i>
        </div>
        <h3 style="font-size:1.3rem;color:var(--light-gold);margin-bottom:15px;">Аудиогид от автора</h3>
        <p style="font-size:0.95rem;line-height:1.6;color:rgba(248,245,240,0.9);">Экскурсия в формате аудиорассказа от самого Фёдора Конюхова.</p>
      </div>
    </div>
  </section>

  <section class="map-section" style="padding:80px 20px;max-width:1300px;margin:0 auto;">
    <h2 class="section-title" data-aos="fade-up" style="font-family:'Playfair Display',serif;font-size:clamp(2rem,4vw,3rem);text-align:center;color:var(--light-gold);margin-bottom:60px;">
      Место проведения
    </h2>
    <div data-aos="fade-up">
      <div id="map"></div>
      <div style="text-align:center;margin-top:20px;color:rgba(248,245,240,0.8);">
        <p>Кронштадт, ул. Цитадельское шоссе, 18</p>
        <p style="margin-top:10px;">Музей военной и морской славы</p>
      </div>
    </div>
  </section>
</main>

<footer style="background:#060f1a;padding:80px 20px;text-align:center;">
  <div style="font-family:'Playfair Display',serif;font-size:clamp(1.5rem,3vw,2rem);color:var(--light-gold);margin-bottom:30px;line-height:1.3;">
    Фёдор Конюхов «Путь к счастью»
  </div>
  <div style="font-size:clamp(0.9rem,1.5vw,1.1rem);line-height:1.6;margin-bottom:40px;color:rgba(248,245,240,0.9);">
    <p>Кронштадт, ул. Цитадельское шоссе, 18</p>
    <p style="margin-top:10px;">Ежедневно с 12:00 до 22:00</p>
    <p style="margin-top:10px;font-size:0.9rem;color:rgba(136,170,204,0.8);">
      По вопросам сотрудничества: +79381612468
    </p>
  </div>
  
  <a href="https://mvms.tn-cloud.ru/event/DA09C5B33464E62FDF718FC56D5FDC27E0C3C819/2025-12-04" target="_blank" class="buy-ticket-btn" onclick="countClick()" style="margin-bottom:50px;">Купить билет</a>
  
  <!-- Обновленные ссылки на соцсети -->
  <div class="social-links">
    <a href="https://m.vk.com/artprostranstvorostov" target="_blank" class="social-link" title="ВКонтакте">
      <i class="fab fa-vk"></i>
    </a>
    <a href="https://artspacerostov.ru/" target="_blank" class="social-link" title="Сайт выставки в Ростове-на-Дону">
      <i class="fas fa-external-link-alt"></i>
    </a>
    <a href="#" class="social-link" title="Телеграм (канал в разработке)" onclick="event.preventDefault(); alert('Телеграм-канал в разработке');">
      <i class="fab fa-telegram"></i>
    </a>
  </div>
  
  <div class="social-placeholder">
    Присоединяйтесь к нашим сообществам!
  </div>
  
  <p style="color:#88aacc;font-size:0.9rem;max-width:600px;margin:30px auto 0;line-height:1.6;padding-top:20px;border-top:1px solid rgba(136,170,204,0.2);">
    © 2025 Иммерсивная выставка Фёдора Конюхова «Путь к счастью». Все права защищены.
  </p>
</footer>

<!-- Ленивая загрузка JavaScript -->
<script>
// Минимальные функции для первого экрана
function countClick() {
  let c = (parseInt(localStorage.getItem('k2025') || 0)) + 1;
  localStorage.setItem('k2025', c);
  document.getElementById('clickCounter').textContent = c;
  document.getElementById('ticketCounter').textContent = Math.floor(c * 0.45);
}

// Переменные для слайдера
let currentSlide = 0;
let slides = [];
let slider;
let dotsContainer;

// ИЗОБРАЖЕНИЯ ДЛЯ СЛАЙДЕРА
const sliderImages = [
  'https://avatars.dzeninfra.ru/get-zen_doc/271828/pub_667efc7f47b77a027f3a71fa_667efc8e47b77a027f3a7af0/scale_1200',
  'https://avatars.dzeninfra.ru/get-zen_doc/271828/pub_667efc7f47b77a027f3a71fa_667efc8e47b77a027f3a7af1/scale_1200',
  'https://avatars.dzeninfra.ru/get-zen_doc/271828/pub_667efc7f47b77a027f3a71fa_667efc8e47b77a027f3a7af3/scale_1200',
  'https://rostovchanka-media.ru/images/news-1/konvistrostov17.jpg',
  'https://konyukhov.ru/wp-content/uploads/2024/03/a6LfTUoAvzo.jpg',
  'https://cdnstatic.rg.ru/uploads/images/181/32/95/lodka__kopiia.jpg',
  'https://kudamoscow.ru/uploads/0bb6b83698594c793be0f04116b38261.jpg',
  'https://riavrn.ru/media/archive/image/2022/09/vN0JZ13cdr2bTVUznMaAGNAK_hm1ROxn.jpg'
];

// Инициализация слайдера
function initSlider() {
  slider = document.getElementById('imageSlider');
  dotsContainer = document.getElementById('sliderDots');
  
  // Создаем слайды
  sliderImages.forEach((imgUrl, index) => {
    const slide = document.createElement('div');
    slide.className = 'slide';
    slide.innerHTML = `
      <div class="img-placeholder" style="height:100%;" data-src="${imgUrl}"></div>
    `;
    slider.appendChild(slide);
    slides.push(slide);
    
    // Создаем точки
    const dot = document.createElement('button');
    dot.className = 'dot' + (index === 0 ? ' active' : '');
    dot.setAttribute('onclick', `goToSlide(${index})`);
    dotsContainer.appendChild(dot);
  });
  
  // Автоматическое перелистывание
  setInterval(() => {
    nextSlide();
  }, 5000);
  
  // Ленивая загрузка изображений
  lazyLoadImages();
}

// Функции слайдера
function nextSlide() {
  currentSlide = (currentSlide + 1) % slides.length;
  updateSlider();
}

function prevSlide() {
  currentSlide = (currentSlide - 1 + slides.length) % slides.length;
  updateSlider();
}

function goToSlide(index) {
  currentSlide = index;
  updateSlider();
}

function updateSlider() {
  slider.style.transform = `translateX(-${currentSlide * 100}%)`;
  
  // Обновляем активную точку
  document.querySelectorAll('.dot').forEach((dot, index) => {
    dot.classList.toggle('active', index === currentSlide);
  });
}

// Загрузка главного изображения
function loadHeroImage() {
  const heroImage = document.getElementById('heroImage');
  if (heroImage) {
    const img = new Image();
    img.src = 'https://storage.yandexcloud.net/storage.yasno.media/nat-geo/images/2024/10/31/6e48becd01e94e5bab00737ac4676ebb.max-2500x1500.jpg';
    img.onload = function() {
      heroImage.style.backgroundImage = `url(${img.src})`;
      heroImage.style.backgroundSize = 'cover';
      heroImage.style.backgroundPosition = 'center';
      heroImage.style.animation = 'none';
    };
    img.onerror = function() {
      // Если изображение не загружается, используем fallback
      heroImage.style.backgroundImage = 'linear-gradient(135deg, var(--gold), var(--light-gold))';
      heroImage.style.animation = 'none';
    };
  }
}

// Ленивая загрузка изображений
function lazyLoadImages() {
  const imageObservers = [];
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const img = entry.target;
        const src = img.getAttribute('data-src');
        if (src) {
          const image = new Image();
          image.src = src;
          image.onload = function() {
            img.style.backgroundImage = `url(${src})`;
            img.style.backgroundSize = 'cover';
            img.style.backgroundPosition = 'center';
            img.style.animation = 'none';
          };
          image.onerror = function() {
            // Если изображение не загружается, оставляем плейсхолдер
            console.log('Не удалось загрузить изображение:', src);
          };
        }
        observer.unobserve(img);
      }
    });
  }, { rootMargin: '50px' });
  
  document.querySelectorAll('.img-placeholder[data-src]').forEach(img => {
    observer.observe(img);
  });
  
  return imageObservers;
}

// Инициализация карты
function initMap() {
  if (typeof L === 'undefined') {
    // Динамически загружаем Leaflet
    const leafletCSS = document.createElement('link');
    leafletCSS.rel = 'stylesheet';
    leafletCSS.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';
    document.head.appendChild(leafletCSS);
    
    const leafletScript = document.createElement('script');
    leafletScript.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
    leafletScript.onload = function() {
      createMap();
    };
    document.head.appendChild(leafletScript);
  } else {
    createMap();
  }
}

function createMap() {
  const map = L.map('map').setView([59.9875, 29.7600], 16);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors',
    maxZoom: 19
  }).addTo(map);
  
  L.marker([59.9875, 29.7600]).addTo(map)
    .bindPopup('<b>Музей "Воинско-морской славы России"</b><br>Кронштадт, ул. Цитадельское шоссе, 18')
    .openPopup();
}

// Главная функция инициализации
window.onload = function() {
  // Анимация заголовка
  const spans = document.querySelectorAll('.handwriting span');
  spans.forEach((span, index) => {
    span.style.animation = `write 1.2s cubic-bezier(0.23,1,0.32,1) ${0.5 + index * 0.18}s forwards`;
  });
  
  // Анимация линии
  const line = document.querySelector('.title-line');
  line.style.animation = 'line 1.5s 1.5s forwards';
  
  // Счётчик
  let c = localStorage.getItem('k2025') || 0;
  document.getElementById('clickCounter').textContent = c;
  document.getElementById('ticketCounter').textContent = Math.floor(c * 0.45);
  
  // Загрузка главного изображения
  loadHeroImage();
  
  // Инициализация слайдера
  initSlider();
  
  // Инициализация карты
  initMap();
  
  // Простая реализация AOS
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('aos-animate');
      }
    });
  }, { threshold: 0.1 });
  
  document.querySelectorAll('[data-aos]').forEach(el => {
    observer.observe(el);
  });
};

// Ключевые стили анимации
const styleSheet = document.createElement('style');
styleSheet.textContent = `
@keyframes write {
  0% { opacity:0; transform:translateY(60px) rotate(-16deg) scale(0.7); }
  70% { transform:translateY(-8px) rotate(4deg) scale(1.1); }
  100% { opacity:1; transform:translateY(0) rotate(0) scale(1); }
}

@keyframes line {
  to { width: min(80%, 600px); }
}

@keyframes fadeIn {
  to { opacity: 1; }
}

/* Адаптивность */
@media (max-width: 768px) {
  .hero-header { min-height: 90vh; }
  .slider-container { max-width: 100%; }
  .slide { height: 400px; }
  .slider-nav { width: 40px; height: 40px; font-size: 1.2rem; }
  .feature-card { padding: 30px 20px; }
  .hero-image-container .img-placeholder { height: 400px; }
  .social-links { gap: 20px; }
  .social-link { width: 45px; height: 45px; font-size: 1.3rem; }
}

@media (max-width: 480px) {
  .hero-header { min-height: 85vh; padding: 15px; }
  .buy-ticket-btn { padding: 15px 40px; font-size: 1.1rem; }
  .stats-container { gap: 30px; }
  .slide { height: 300px; }
  .slider-nav { width: 35px; height: 35px; font-size: 1rem; }
  .hero-image-container .img-placeholder { height: 300px; }
  .social-links { gap: 15px; margin-top: 30px; }
  .social-link { width: 40px; height: 40px; font-size: 1.2rem; }
}
`;
document.head.appendChild(styleSheet);
</script>

<!-- Дефер загрузка иконок FontAwesome -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</noscript>
</body>

</html>






